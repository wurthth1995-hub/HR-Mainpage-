<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wurth HR Policy</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Firebase SDK (Version 8 Compat for easier HTML usage) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
        
        .fade-in { animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Original Styles */
        .manual-table { width: 100%; border-collapse: collapse; font-size: 0.875rem; min-width: 600px; }
        .manual-table th { background-color: #fef2f2; color: #991b1b; font-weight: bold; text-align: left; padding: 0.75rem; border: 1px solid #fee2e2; }
        .manual-table td { padding: 0.75rem; border: 1px solid #e5e7eb; vertical-align: top; }
        .manual-table tr:nth-child(even) { background-color: #f9fafb; }
        .announcement-card { background: linear-gradient(135deg, #ffffff 0%, #fff1f2 100%); border-left: 5px solid #dc2626; }
        .skeleton { background: #e5e7eb; border-radius: 4px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }
        
        /* Admin & Edit Mode Styles */
        .editable-input { border: 2px dashed #dc2626; background-color: #fff; padding: 4px; border-radius: 4px; width: 100%; }
        .editable-textarea { border: 2px dashed #dc2626; background-color: #fff; padding: 4px; border-radius: 4px; width: 100%; min-height: 100px; }

        /* Floating Action Button */
        .fab-btn {
            position: fixed; bottom: 2rem; right: 2rem; width: 3.5rem; height: 3.5rem;
            background-color: #dc2626; color: white; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
            transition: transform 0.2s, background-color 0.2s; z-index: 40; cursor: pointer;
        }
        .fab-btn:hover { transform: scale(1.1); background-color: #b91c1c; }
        .fab-btn:active { transform: scale(0.95); }

        /* Rich Text Editor Toolbar */
        .rich-toolbar { display: flex; gap: 0.5rem; padding: 0.5rem; background: #f3f4f6; border-radius: 0.5rem 0.5rem 0 0; border-bottom: 1px solid #e5e7eb; flex-wrap: wrap; }
        .tool-btn { padding: 0.25rem 0.5rem; border-radius: 0.25rem; background: white; border: 1px solid #d1d5db; color: #374151; cursor: pointer; font-size: 0.875rem; display: flex; align-items: center; justify-content: center; }
        .tool-btn:hover { background: #e5e7eb; }
        .tool-btn.active { background: #e5e7eb; border-color: #9ca3af; }
        .rich-editor { min-height: 150px; padding: 1rem; background: white; border: 1px solid #d1d5db; border-top: none; border-radius: 0 0 0.5rem 0.5rem; outline: none; overflow-y: auto; }
        
        /* New Post Card Style */
        .extra-card { background: white; border-radius: 0.75rem; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border: 1px solid #f3f4f6; margin-bottom: 1rem; overflow: hidden; transition: transform 0.2s; }
        .extra-card:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.08); }
        .button-wrapper::before { animation: spin-gradient 4s linear infinite; }
        @keyframes spin-gradient { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Pinned & Hidden Styles */
        .card-pinned { border: 2px solid #fbbf24; background: linear-gradient(to bottom right, #fffbeb, #ffffff); }
        .card-hidden { opacity: 0.6; background-color: #f3f4f6; border: 1px dashed #9ca3af; }
        .pin-badge { background-color: #fbbf24; color: #92400e; font-size: 0.75rem; padding: 2px 8px; border-radius: 999px; display: inline-flex; align-items: center; gap: 4px; font-weight: bold; margin-bottom: 0.5rem; }
    </style>
</head>
<body id="top" class="bg-gray-50 text-gray-800 pb-16 overflow-x-hidden">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div onclick="window.scrollTo({top: 0, behavior: 'smooth'})" class="flex items-center gap-2 sm:gap-3 overflow-hidden cursor-pointer">
                    <img src="https://www.wuerth.co.th/media/system/layout_wl2bootstrap/bootstrap_system_images/wuerth_logo_big.png" alt="Wuerth Logo" class="h-6 sm:h-8 w-auto flex-shrink-0">
                    <div class="hidden sm:block h-6 w-px bg-gray-300"></div>
                </div>
                <!-- Desktop Nav -->
                <div class="hidden lg:flex space-x-1">
                    <button onclick="filterContent('home')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium transition-colors bg-red-50 text-red-700 border border-red-100 hover:bg-red-100 ring-2 ring-red-200" data-tab="home"><i data-lucide="home" class="w-4 h-4 inline mr-1"></i>หน้าหลัก</button>
                    <button onclick="filterContent('policy')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-red-700 hover:bg-gray-50" data-tab="policy"><i data-lucide="clipboard-list" class="w-4 h-4 inline mr-1"></i>สิทธิการลา</button>
                    <button onclick="filterContent('manual')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-red-700 hover:bg-gray-50" data-tab="manual"><i data-lucide="book" class="w-4 h-4 inline mr-1"></i>คู่มือพนักงาน</button>
                    <button onclick="filterContent('calculator')" class="nav-btn px-3 py-2 rounded-md text-sm font-medium transition-colors text-gray-600 hover:text-red-700 hover:bg-gray-50" data-tab="calculator"><i data-lucide="calculator" class="w-4 h-4 inline mr-1"></i>คำนวณสิทธิ</button>
                </div>
                <!-- Mobile Menu Button -->
                <div class="lg:hidden">
                    <button onclick="toggleMobileMenu()" class="text-gray-600 focus:outline-none p-2 rounded-md hover:bg-gray-100"><i data-lucide="menu" id="menu-icon"></i></button>
                </div>
            </div>
        </div>
        <!-- Mobile Nav Menu -->
        <div id="mobile-menu" class="hidden lg:hidden bg-white border-t border-gray-100 shadow-lg absolute w-full z-50">
            <div class="px-4 pt-2 pb-4 space-y-2">
                <button onclick="filterContent('home')" class="mobile-nav-btn block w-full text-left px-4 py-3 rounded-lg text-base font-medium bg-red-50 text-red-700 border border-red-100" data-tab="home">หน้าหลัก</button>
                <button onclick="filterContent('policy')" class="mobile-nav-btn block w-full text-left px-4 py-3 rounded-lg text-base font-medium text-gray-600" data-tab="policy">สิทธิการลา</button>
                <button onclick="filterContent('manual')" class="mobile-nav-btn block w-full text-left px-4 py-3 rounded-lg text-base font-medium text-gray-600" data-tab="manual">คู่มือพนักงาน</button>
                <button onclick="filterContent('calculator')" class="mobile-nav-btn block w-full text-left px-4 py-3 rounded-lg text-base font-medium text-gray-600" data-tab="calculator">คำนวณสิทธิวันลา</button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-6">
        
        <!-- ================= HOME SECTION ================= -->
        <section id="home-section" class="content-section fade-in mb-8">
            <div class="mb-6 sm:mb-8 text-center sm:text-left">
                <h1 class="text-2xl sm:text-3xl font-extrabold text-gray-900 tracking-tight">
                    <span class="text-red-700">Wurth</span> Employee Service
                </h1>
                <p class="text-gray-500 mt-2 text-sm sm:text-base">ยินดีต้อนรับสู่ระบบบริการข้อมูลพนักงานและสวัสดิการ</p>
            </div>

            <!-- CONTACT SECTION (EDITABLE) -->
            <div id="action-banner" class="bg-gray-900 text-white p-4 lg:p-6 rounded-xl shadow-lg mb-6 sm:mb-8 border-l-4 border-red-600 relative group transition-transform hover:scale-[1.01] duration-300">
                <div class="flex flex-col lg:flex-row items-start space-y-4 lg:space-y-0 lg:space-x-6">
                    <div class="bg-red-600 p-3 rounded-full hidden lg:block shadow-lg flex-shrink-0">
                        <i data-lucide="file-text" class="w-8 h-8 text-white"></i>
                    </div>
                    <div class="w-full">
                        <div class="flex justify-between items-start">
                            <h3 class="text-lg lg:text-xl font-bold mb-2 flex items-center gap-2">
                                <div class="bg-red-600 p-1.5 rounded-lg lg:hidden"><i data-lucide="file-text" class="w-4 h-4 text-white"></i></div>
                                ช่องทางการติดต่อ
                            </h3>
                            <!-- ปุ่มแก้ไขข้อมูลติดต่อ (แสดงเมื่อ Login) -->
                            <div class="flex gap-2">
                               <button onclick="openChangePasswordModal()" id="change-password-btn" class="hidden text-gray-400 hover:text-white p-1 text-xs items-center gap-1 border border-gray-600 rounded px-2">
                                  <i data-lucide="key" class="w-3 h-3"></i> เปลี่ยนรหัสแอดมิน
                               </button>
                               <button onclick="toggleContactEdit()" id="contact-edit-btn" class="hidden text-gray-400 hover:text-white p-1 border border-gray-600 rounded px-2 text-xs flex items-center gap-1">
                                  <i data-lucide="pencil" class="w-3 h-3"></i> แก้ไขการติดต่อ
                               </button>
                            </div>
                        </div>

                        <p class="text-gray-300 text-sm mb-4 mt-0 leading-relaxed">
                            หากมีข้อสงสัย คำถามเพิ่มเติม หรือพบปัญหาใด ๆ สามารถติดต่อสอบถามได้โดยตรง
                        </p>
                        
                        <!-- Contact Display View -->
                        <div id="contact-display" class="flex flex-col sm:flex-row gap-3 w-full">
                            <a href="#" id="display-phone-link" class="flex items-center justify-center sm:justify-start px-4 py-3 sm:py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm border border-gray-700 transition-colors w-full sm:w-auto">
                                <i data-lucide="phone" class="w-4 h-4 mr-2 text-red-500"></i> <span id="display-phone">Loading...</span>
                            </a>
                            <a href="#" id="display-email-link" class="flex items-center justify-center sm:justify-start px-4 py-3 sm:py-2 bg-gray-800 hover:bg-gray-700 rounded-lg text-sm border border-gray-700 transition-colors w-full sm:w-auto break-all">
                                <i data-lucide="mail" class="w-4 h-4 mr-2 text-red-500"></i> <span id="display-email">Loading...</span>
                            </a>
                        </div>

                        <!-- Contact Edit View (Hidden by default) -->
                        <div id="contact-edit" class="hidden flex flex-col sm:flex-row gap-3 w-full">
                            <input type="text" id="edit-phone" placeholder="เบอร์โทรศัพท์" class="text-black px-4 py-2 rounded-lg text-sm border border-gray-300 w-full sm:w-auto">
                            <input type="text" id="edit-email" placeholder="อีเมล" class="text-black px-4 py-2 rounded-lg text-sm border border-gray-300 w-full sm:w-auto">
                            <button onclick="saveContact()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-bold">บันทึก</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ANNOUNCEMENT CARD (EDITABLE) -->
            <div class="announcement-card bg-white p-5 sm:p-8 rounded-xl shadow-md mb-8 relative overflow-hidden">
                <i data-lucide="megaphone" class="absolute -right-6 -bottom-6 w-32 h-32 text-red-50 opacity-50 transform rotate-12"></i>
                <div class="relative z-10">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="p-2 bg-red-100 rounded-lg text-red-600"><i data-lucide="megaphone" class="w-6 h-6"></i></div>
                            <h2 class="text-xl sm:text-2xl font-bold text-gray-800">ประกาศจากฝ่ายบุคคล</h2>
                            <button onclick="handleAdminClick()" id="admin-btn" class="text-gray-300 hover:text-red-500 transition-colors p-1 rounded-full focus:outline-none">
                                <i data-lucide="lock" id="admin-icon" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <button onclick="saveAnnouncement()" id="save-btn" class="hidden bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-bold shadow-md hover:bg-red-700 transition-all flex items-center gap-2">
                            <i data-lucide="save" class="w-4 h-4"></i> บันทึก
                        </button>
                    </div>

                    <div id="announcement-loading" class="space-y-4 py-2">
                        <div class="skeleton h-8 w-3/4"></div>
                        <div class="skeleton h-4 w-full"></div>
                    </div>

                    <div id="announcement-content" class="hidden">
                        <h3 id="ann-topic" class="text-lg font-bold text-red-700 mb-3"></h3>
                        <div id="ann-body" class="text-gray-600 text-sm sm:text-base leading-relaxed whitespace-pre-line"></div>
                        <div class="mt-6 pt-4 border-t border-gray-100 flex items-center justify-between text-xs text-gray-400">
                            <span>Wurth Thailand HR</span>
                            <span id="ann-date"></span>
                        </div>
                    </div>

                    <div id="announcement-edit" class="hidden space-y-3">
                        <div><label class="text-xs text-gray-500 font-bold">หัวข้อประกาศ:</label><input type="text" id="edit-topic" class="editable-input text-lg font-bold text-red-700"></div>
                        <div><label class="text-xs text-gray-500 font-bold">เนื้อหา:</label><textarea id="edit-body" class="editable-textarea text-gray-600 text-sm leading-relaxed" rows="5"></textarea></div>
                    </div>
                </div>
            </div>

            <!-- CONTAINER FOR ADDITIONAL POSTS -->
            <div id="additional-posts-container">
                <!-- New cards will be injected here -->
            </div>

            <!-- Quick Links -->
            <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                <button onclick="filterContent('policy')" class="p-4 bg-white rounded-xl shadow-sm hover:shadow-md transition-all border border-gray-100 hover:border-red-200 group text-left">
                    <div class="p-2 bg-blue-50 text-blue-600 rounded-lg w-fit mb-3 group-hover:scale-110 transition-transform"><i data-lucide="clipboard-list" class="w-6 h-6"></i></div>
                    <span class="font-bold text-gray-800 block">สิทธิการลา</span>
                </button>
                <button onclick="filterContent('manual')" class="p-4 bg-white rounded-xl shadow-sm hover:shadow-md transition-all border border-gray-100 hover:border-red-200 group text-left">
                    <div class="p-2 bg-orange-50 text-orange-600 rounded-lg w-fit mb-3 group-hover:scale-110 transition-transform"><i data-lucide="book" class="w-6 h-6"></i></div>
                    <span class="font-bold text-gray-800 block">คู่มือพนักงาน</span>
                </button>
                 <button onclick="filterContent('calculator')" class="p-4 bg-white rounded-xl shadow-sm hover:shadow-md transition-all border border-gray-100 hover:border-red-200 group text-left col-span-2 sm:col-span-1">
                    <div class="p-2 bg-green-50 text-green-600 rounded-lg w-fit mb-3 group-hover:scale-110 transition-transform"><i data-lucide="calculator" class="w-6 h-6"></i></div>
                    <span class="font-bold text-gray-800 block">คำนวณสิทธิ</span>
                </button>
            </div>
        </section>

        <!-- ================= POLICY SECTION ================= -->
        <section id="policy-section" class="content-section fade-in mb-8 hidden">
             <div class="flex items-center gap-3 mb-4 sm:mb-6 pb-4 border-b border-gray-200">
                <div class="p-2 sm:p-3 rounded-xl bg-gradient-to-br from-red-600 to-red-800 text-white shadow-md">
                    <i data-lucide="clipboard-list" class="w-5 h-5 sm:w-6 sm:h-6"></i>
                </div>
                <div>
                    <h2 class="text-lg sm:text-2xl font-bold text-gray-800">สิทธิการลา</h2>
                    <p class="text-xs sm:text-sm text-gray-500">ระเบียบการลาประเภทต่างๆ ของบริษัท</p>
                </div>
            </div>
            <!-- Policy Accordion Container -->
            <div class="space-y-3 sm:space-y-4">
                <!-- Vacation -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('policy-vacation')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <div class="p-1.5 sm:p-2 rounded-lg bg-red-50 text-red-700"><i data-lucide="palmtree" class="w-4 h-4 sm:w-5 sm:h-5"></i></div>
                            <span class="font-bold text-base sm:text-lg text-gray-800">สิทธิวันหยุดพักผ่อนประจำปี</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-policy-vacation" class="w-5 h-5 text-gray-400 transition-transform duration-300 rotate-180"></i>
                    </button>
                    <div id="policy-vacation" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 sm:gap-6">
                            <!-- Card 1 -->
                            <div class="bg-white rounded-xl shadow-sm border-t-4 border-red-700 p-4 sm:p-5 w-full">
                                <div class="flex justify-between items-start mb-4">
                                    <h3 class="text-base sm:text-lg font-bold text-gray-800">เงื่อนไขทั่วไป</h3>
                                    <span class="bg-red-50 text-red-700 text-[10px] font-bold px-2 py-1 rounded-full border border-red-200 uppercase">Pro-rate</span>
                                </div>
                                <div class="space-y-3 text-gray-600 text-sm">
                                    <div class="flex items-start gap-3">
                                        <i data-lucide="check-circle" class="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"></i>
                                        <span><span class="font-semibold text-gray-900">พนักงานใหม่:</span> ได้สิทธิแบบเฉลี่ย (Pro-rate) หลังผ่านทดลองงาน</span>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <i data-lucide="check-circle" class="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"></i>
                                        <span><span class="font-semibold text-gray-900">ช่วงทดลองงาน:</span> ใช้สิทธิได้เฉพาะกรณี <span class="underline text-red-800">ฉุกเฉิน</span> เท่านั้น</span>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <i data-lucide="check-circle" class="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"></i>
                                        <span><span class="font-semibold text-gray-900">โอนวันลา:</span> ได้สูงสุด 5 วัน (ใช้ภายใน 4 เดือนแรกของปีถัดไป)</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Card 2 -->
                            <div class="bg-white rounded-xl shadow-sm border-t-4 border-red-700 p-4 sm:p-5 w-full">
                                <div class="flex justify-between items-start mb-4">
                                    <h3 class="text-base sm:text-lg font-bold text-gray-800">ตารางสิทธิวันลา</h3>
                                    <span class="bg-red-50 text-red-700 text-[10px] font-bold px-2 py-1 rounded-full border border-red-200 uppercase">Service Years</span>
                                </div>
                                <div class="space-y-3 text-gray-600 text-sm">
                                    <div class="flex justify-between items-center border-b border-gray-50 pb-2">
                                        <span class="text-gray-500">อายุงาน &lt; 2 ปี</span>
                                        <span class="font-bold text-red-700 bg-red-50 px-2 py-0.5 rounded">14 วัน</span>
                                    </div>
                                    <div class="flex justify-between items-center border-b border-gray-50 pb-2">
                                        <span class="text-gray-500">อายุงาน 2 - &lt; 5 ปี</span>
                                        <span class="font-bold text-red-700 bg-red-50 px-2 py-0.5 rounded">17 วัน</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-500">อายุงาน &ge; 5 ปี / บริหาร</span>
                                        <span class="font-bold text-red-700 bg-red-50 px-2 py-0.5 rounded">19 วัน</span>
                                    </div>
                                </div>
                            </div>
                            <!-- Card 3 -->
                            <div class="bg-white rounded-xl shadow-sm border-t-4 border-red-700 p-4 sm:p-5 w-full">
                                <div class="flex justify-between items-start mb-4">
                                    <h3 class="text-base sm:text-lg font-bold text-gray-800">ระเบียบการยื่นใบลา</h3>
                                    <span class="bg-red-50 text-red-700 text-[10px] font-bold px-2 py-1 rounded-full border border-red-200 uppercase">Important</span>
                                </div>
                                <div class="space-y-3 text-gray-600 text-sm">
                                    <div class="flex items-start gap-3">
                                        <i data-lucide="clock" class="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"></i>
                                        <span><span class="font-semibold text-gray-900">ลา &lt; 5 วัน:</span> ยื่นล่วงหน้าอย่างน้อย 5 วัน</span>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <i data-lucide="clock" class="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"></i>
                                        <span><span class="font-semibold text-gray-900">ลา &ge; 5 วัน:</span> ยื่นล่วงหน้า 2 สัปดาห์</span>
                                    </div>
                                    <div class="flex items-start gap-3">
                                        <i data-lucide="alert-circle" class="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"></i>
                                        <span><span class="font-semibold text-gray-900">ลากิจฉุกเฉิน:</span> 3 วัน/ปี (แจ้งก่อน 10.00 น.)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Sick Leave -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('policy-sick')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <div class="p-1.5 sm:p-2 rounded-lg bg-red-50 text-red-700"><i data-lucide="thermometer" class="w-4 h-4 sm:w-5 sm:h-5"></i></div>
                            <span class="font-bold text-base sm:text-lg text-gray-800">วันลาป่วย & รักษาพยาบาล</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-policy-sick" class="w-5 h-5 text-gray-400 transition-transform duration-300 rotate-180"></i>
                    </button>
                    <div id="policy-sick" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="bg-white rounded-xl shadow-sm border-t-4 border-red-700 overflow-hidden">
                            <div class="p-4 sm:p-8 flex flex-col lg:flex-row gap-6 lg:gap-8 lg:items-center">
                                <div class="flex-1 space-y-4 sm:space-y-5 w-full">
                                    <div class="flex items-center gap-4">
                                        <div class="text-4xl sm:text-5xl font-extrabold text-gray-900">30</div>
                                        <div class="text-xs text-gray-500 font-bold uppercase tracking-wider leading-tight">วัน / ปี<br/>ที่ได้รับ<br/>ค่าจ้างปกติ</div>
                                    </div>
                                    <div class="h-px bg-gray-100 w-full"></div>
                                    <ul class="space-y-3">
                                        <li class="flex items-start gap-3 text-gray-600 text-sm">
                                            <i data-lucide="file-plus" class="w-5 h-5 text-red-600 flex-shrink-0"></i>
                                            <span>ลาป่วยติดต่อกัน <span class="font-bold text-gray-900">&ge; 3 วัน</span> ต้องแนบใบรับรองแพทย์</span>
                                        </li>
                                        <li class="flex items-start gap-3 text-gray-600 text-sm">
                                            <i data-lucide="hospital" class="w-5 h-5 text-red-600 flex-shrink-0"></i>
                                            <span>กรณี Admit รพ. ต้องแจ้งหัวหน้าและส่งใบรับรองแพทย์</span>
                                        </li>
                                        <li class="flex items-start gap-3 text-gray-600 text-sm">
                                            <i data-lucide="phone-call" class="w-5 h-5 text-red-600 flex-shrink-0"></i>
                                            <span>แจ้งหัวหน้า หรือ HR ก่อนเวลา <span class="font-bold text-gray-900">10.00 น.</span> ของวันที่ลา</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="w-full lg:w-1/3 bg-red-50 p-4 sm:p-5 rounded-xl border border-red-100">
                                    <h4 class="font-bold flex items-center gap-2 mb-3 text-red-800 text-sm sm:text-base">
                                        <i data-lucide="shield-alert" class="w-5 h-5"></i> ข้อควรระวัง
                                    </h4>
                                    <p class="text-xs sm:text-sm text-gray-700 leading-relaxed">
                                        การใช้สิทธิผิดวิธีหรือเกินสิทธิ วันลาอาจถูกหัก หรือพิจารณาเป็นการลาโดยไม่ได้รับค่าจ้าง (Leave without pay) ในวันที่ลานั้นๆ
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Special Leave -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('policy-special')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <div class="p-1.5 sm:p-2 rounded-lg bg-red-50 text-red-700"><i data-lucide="heart" class="w-4 h-4 sm:w-5 sm:h-5"></i></div>
                            <span class="font-bold text-base sm:text-lg text-gray-800">วันลาพิเศษ & ครอบครัว</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-policy-special" class="w-5 h-5 text-gray-400 transition-transform duration-300 rotate-180"></i>
                    </button>
                    <div id="policy-special" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-4 gap-4">
                            <!-- Maternity -->
                            <div class="bg-white p-4 sm:p-5 rounded-xl shadow-sm border-l-4 border-pink-500 hover:shadow-md transition-all w-full">
                                <div class="flex items-center gap-2 mb-3 text-pink-600 font-bold">
                                    <i data-lucide="baby" class="w-5 h-5"></i> ลาคลอด (หญิง)
                                </div>
                                <ul class="text-sm space-y-2 text-gray-600">
                                    <li>• สูงสุด <strong>98 วัน</strong></li>
                                    <li>• รับค่าจ้าง 45 วัน</li>
                                    <li>• ยื่นขอ 4 สัปดาห์ก่อนลา</li>
                                </ul>
                            </div>
                            <!-- Marriage -->
                            <div class="bg-white p-4 sm:p-5 rounded-xl shadow-sm border-l-4 border-red-500 hover:shadow-md transition-all w-full">
                                <div class="flex items-center gap-2 mb-3 text-red-600 font-bold">
                                    <i data-lucide="heart-handshake" class="w-5 h-5"></i> ลาแต่งงาน
                                </div>
                                <ul class="text-sm space-y-2 text-gray-600">
                                    <li>• ได้ <strong>3 วัน</strong></li>
                                    <li>• อายุงาน &ge; 1 ปี</li>
                                    <li>• แนบใบสำคัญการสมรส</li>
                                </ul>
                            </div>
                            <!-- Paternity -->
                            <div class="bg-white p-4 sm:p-5 rounded-xl shadow-sm border-l-4 border-blue-500 hover:shadow-md transition-all w-full">
                                <div class="flex items-center gap-2 mb-3 text-blue-600 font-bold">
                                    <i data-lucide="users" class="w-5 h-5"></i> ลาดูแลบุตร (ชาย)
                                </div>
                                <ul class="text-sm space-y-2 text-gray-600">
                                    <li>• ได้ <strong>5 วัน/บุตร</strong></li>
                                    <li>• สูงสุด 3 คน</li>
                                    <li>• ต้องแนบสูติบัตร</li>
                                </ul>
                            </div>
                            <!-- Funeral -->
                            <div class="bg-white p-4 sm:p-5 rounded-xl shadow-sm border-l-4 border-gray-600 hover:shadow-md transition-all w-full">
                                <div class="flex items-center gap-2 mb-3 text-gray-700 font-bold">
                                    <div class="w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center text-[10px]">F</div> งานศพ
                                </div>
                                <ul class="text-sm space-y-2 text-gray-600">
                                    <li>• ได้ <strong>3 วัน</strong></li>
                                    <li>• เงินช่วย 10,000 บาท </li>
                                    <li>• พ่อ, แม่, คู่สมรส, บุตร</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Other Leave -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('policy-other')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <div class="p-1.5 sm:p-2 rounded-lg bg-red-50 text-red-700"><i data-lucide="book-open" class="w-4 h-4 sm:w-5 sm:h-5"></i></div>
                            <span class="font-bold text-base sm:text-lg text-gray-800">การลาอื่นๆ</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-policy-other" class="w-5 h-5 text-gray-400 transition-transform duration-300 rotate-180"></i>
                    </button>
                    <div id="policy-other" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
                            <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 border-t-4 border-red-700 p-4 sm:p-6 w-full">
                                <div class="flex justify-between items-start mb-4">
                                    <h3 class="text-base sm:text-lg font-bold text-gray-800 flex items-center gap-2">
                                        <i data-lucide="graduation-cap" class="w-5 h-5 text-gray-400"></i>
                                        การพัฒนาตนเอง & สุขภาพ
                                    </h3>
                                </div>
                                <div class="space-y-4 text-gray-600 text-sm">
                                    <div class="flex justify-between items-start border-b border-gray-100 pb-3">
                                        <div>
                                            <span class="font-bold text-gray-800 block">ลาสอบ/ศึกษาต่อ</span>
                                            <span class="text-xs text-gray-500">ต้องมีหลักฐานการสมัครสอบ</span>
                                        </div>
                                        <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-bold whitespace-nowrap">6 วัน/ปี</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <span class="font-bold text-gray-800 block">ลาทำหมัน</span>
                                            <span class="text-xs text-gray-500">ตามระยะเวลาในใบรับรองแพทย์</span>
                                        </div>
                                        <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-bold whitespace-nowrap">สูงสุด 5 วัน</span>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow duration-300 border-t-4 border-red-700 p-4 sm:p-6 w-full">
                                <div class="flex justify-between items-start mb-4">
                                    <h3 class="text-base sm:text-lg font-bold text-gray-800 flex items-center gap-2">
                                        <i data-lucide="flag" class="w-5 h-5 text-gray-400"></i>
                                        หน้าที่พลเมือง & ศาสนา
                                    </h3>
                                </div>
                                <div class="space-y-4 text-gray-600 text-sm">
                                    <div class="flex justify-between items-start border-b border-gray-100 pb-3">
                                        <div>
                                            <span class="font-bold text-gray-800 block">ลาราชการทหาร</span>
                                            <span class="text-xs text-gray-500">เรียกพลเพื่อฝึกวิชาทหาร</span>
                                        </div>
                                        <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-bold whitespace-nowrap">60 วัน</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <span class="font-bold text-gray-800 block">ลาบวช</span>
                                            <span class="text-xs text-gray-500">ตามอายุงานและระเบียบบริษัท</span>
                                        </div>
                                        <span class="bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-bold whitespace-nowrap">ตามกฎหมาย</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mt-6 sm:mt-8 bg-amber-50 border border-amber-200 p-4 sm:p-5 rounded-xl flex flex-col lg:flex-row items-center justify-center text-center lg:text-left gap-4">
                            <div class="p-2 bg-amber-100 rounded-full text-amber-600">
                                <i data-lucide="alert-triangle" class="w-6 h-6"></i>
                            </div>
                            <div>
                                <p class="text-amber-900 font-medium text-sm">
                                    การใช้สิทธิเกิน หรือไม่ถูกต้อง จะถูกหักวันหยุดพักผ่อนหรือเป็นการลาไม่รับค่าจ้าง (Leave without Pay)
                                </p>
                                <p class="text-amber-800 text-xs mt-1">
                                    การลาทุกประเภทต้องได้รับ <span class="font-bold underline">อนุมัติจากหัวหน้างานและฝ่ายบริหารอาวุโส</span>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ================= MANUAL SECTION ================= -->
        <section id="manual-section" class="content-section fade-in mb-8 hidden">
             <div class="flex items-center gap-3 mb-4 sm:mb-6 pb-4 border-b border-gray-200">
                <div class="p-2 sm:p-3 rounded-xl bg-gradient-to-br from-gray-700 to-gray-900 text-white shadow-md">
                    <i data-lucide="book-open-check" class="w-5 h-5 sm:w-6 sm:h-6"></i>
                </div>
                <div>
                    <h2 class="text-lg sm:text-2xl font-bold text-gray-800">คู่มือการจ้างงาน</h2>
                    <p class="text-xs sm:text-sm text-gray-500">บริษัท เวือร์ท (ประเทศไทย) จำกัด (เวอร์ชั่น 3.3 ฉบับย่อ)</p>
                </div>
            </div>
            <!-- Accordion Container -->
            <div class="space-y-3 sm:space-y-4">
                <!-- Chapter 1 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-1')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 1</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">สัญญาจ้างแรงงาน</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-1" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-1" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <h4 class="font-bold text-red-700 mb-3 text-lg">การจำแนกประเภทงานและการจัดลำดับ</h4>
                        <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm mb-6 bg-white table-container">
                            <table class="manual-table">
                                <thead>
                                    <tr>
                                        <th>กลุ่ม</th>
                                        <th>ระดับ</th>
                                        <th>ตำแหน่ง</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="font-semibold align-middle" rowspan="6">ฝ่ายบริหารอาวุโส</td>
                                        <td>SM 1</td>
                                        <td>ผู้อำนวยการภูมิภาค</td>
                                    </tr>
                                    <tr>
                                        <td>SM 2</td>
                                        <td>กรรมการผู้จัดการ/ประธานเจ้าหน้าที่บริหาร</td>
                                    </tr>
                                    <tr>
                                        <td>SM 3</td>
                                        <td>ประธานเจ้าหน้าที่ฝ่ายการเงิน</td>
                                    </tr>
                                    <tr>
                                        <td>SM 4</td>
                                        <td>
                                            <div class="mb-1">ฝ่ายขาย = ผู้อำนวยการฝ่ายขายประจำภูมิภาค</div>
                                            <div>ภายใน = ผู้อำนวยการฝ่ายการเงินประจำภูมิภาค</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>SM 5</td>
                                        <td>
                                            <div class="mb-1">ฝ่ายขาย = ผู้อำนวยการฝ่ายขาย</div>
                                            <div>ภายใน = ผู้อำนวยการฝ่ายขาย</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>SM 6</td>
                                        <td>ผู้อำนวยการ (ไม่มีผู้ใต้บังคับบัญชา)</td>
                                    </tr>
                                    <tr>
                                        <td class="font-semibold align-middle" rowspan="3">ฝ่ายบริหาร</td>
                                        <td>M1</td>
                                        <td>
                                            <div class="mb-1">ฝ่ายขาย = ผู้บริหารแผนก</div>
                                            <div>ภายใน = ผู้บริหารฝ่าย</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>M2</td>
                                        <td>
                                            <div class="mb-1">ฝ่ายขาย = ผู้จัดการเขตขายอาวุโส</div>
                                            <div>ภายใน = ผู้จัดการแผนก</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>M3</td>
                                        <td>
                                            <div class="mb-1">ฝ่ายขาย = ผู้จัดการเขตขาย/หัวหน้าโครงการ (ถาวร)</div>
                                            <div>ภายใน = หัวหน้างาน/หัวหน้าทีมงาน/ผู้ช่วยผู้จัดการ</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="font-semibold align-middle" rowspan="4">พนักงานปฏิบัติการ</td>
                                    </tr>
                                     <tr>
                                        <td>E1</td>
                                        <td>
                                            <div class="mb-1">ผู้จัดการฝ่ายขายลูกค้าองค์กรใหญ่/ผู้จัดการแผนกด้านพัฒนาธุรกิจ/หัวหน้าโครงการ (ชั่วคราว) (ไม่มีผู้ใต้บังคับบัญชา)</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>E2</td>
                                        <td>
                                            <div class="mb-1">ฝ่ายขาย = พนักงานที่ปรึกษางานขายอาวุโส</div>
                                            <div>ภายใน = พนักงานปฏิบัติการอาวุโส</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>E3</td>
                                        <td>
                                            <div class="mb-1">ฝ่ายขาย = พนักงานงานขาย</div>
                                            <div>ภายใน = พนักงานปฏิบัติการอาวุโส</div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="font-semibold align-middle" rowspan="3">ไม่ใช่พนักงานปฏิบัติการ</td>
                                        <td>C1</td>
                                        <td>พนักงานปฏิบัติงานอาวุโส</td>
                                    </tr>
                                    <tr>
                                        <td>C2</td>
                                        <td>พนักงานปฏิบัติงาน</td>
                                    </tr>
                                    <tr>
                                        <td>C3</td>
                                        <td>ฝึกงาน</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="text-xs text-gray-500 mt-2 p-2">* หมายเหตุ: ตำแหน่ง 3 และ 6 อยู่ต่ำที่สุด และ 1 อยู่สูงที่สุดของแต่ละกลุ่ม</p>
                        </div>
                        <div class="mt-6 bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                          <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                            <i data-lucide="file-check" class="w-5 h-5"></i> การโอนย้ายและการไปปฏิบัติงานที่หน่วยงานอื่น
                          </h4>
                          <ul class=" list-outside ml-5 text-sm text-gray-700 space-y-2">
                             <li>บริษัทมี<u>ดุลพินิจเด็ดขาด</u>ในการโอนย้ายและส่งพนักงานไปปฏิบัติงานในส่วนแผนกหรือสํานักงานภูมิภาคของบริษัท ตามความต้องการทางธุรกิจ ดังต่อไปนี้</li>
                             <ul class="list-disc list-outside mt-2 ml-5 ">
                               <li>บริการหรือความเชี่ยวชาญที่หน่วยงานที่รับการโอนย้าย</li>
                               <li>พนักงานปฏิบัติงานในตําแหน่งเดียวกันมาเป็นเวลานาน</li>
                               <li>การจัดตําแหน่งใหม่ให้กับพนักงาน</li>
                               <li>การปรับโครงสร้างบริษัท</li>
                             </ul>
                           </ul>
                        </div>
                        <h4 class="font-bold text-red-700 mb-3 text-lg mt-6">การทดลองงาน</h4>
                        <ul class="list-disc list-outside ml-5 space-y-2 text-gray-700">
                            <li><strong>ระยะเวลา:</strong> สูงสุด 119 วัน สำหรับการจ้างงานทุกประเภท</li>
                            <li><strong>การประเมิน:</strong> ต้องมีการประเมินอย่างน้อย 1 ครั้งระหว่างทดลองงาน กับหัวหน้าแผนกและกรรมการผู้จัดการ</li>
                            <li><strong>การบรรจุ:</strong> บริษัทจะแจ้งเป็นหนังสือ หากไม่ผ่านจะมีการแจ้งล่วงหน้า (1 รอบการจ่ายค่าจ้าง)</li>
                            <li><strong>การยกเลิกสัญญา:</strong> บริษัทสงวนสิทธิ์เลิกจ้างทันทีหากละทิ้งงาน หรือมีพฤติกรรมไม่เหมาะสม</li>
                        </ul>
                    </div>
                </div>
                <!-- Chapter 2 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-2')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 2</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">ชั่วโมงทำงาน</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-2" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-2" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <h4 class="font-bold text-red-700 mb-3 text-lg">2.1 เวลาทำงานปกติ</h4>
                        <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm mb-6 bg-white table-container">
                            <table class="manual-table">
                                <thead>
                                    <tr>
                                        <th>สถานที่ / ฝ่าย</th>
                                        <th>วันทำงาน</th>
                                        <th>เวลาทำงาน</th>
                                        <th>เวลาพัก</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="font-bold">สำนักงาน</td>
                                        <td>จันทร์ - ศุกร์</td>
                                        <td>09:00 - 18:00(เริ่ม 07:00-09:00)</td>
                                        <td>12:00 - 13:00</td>
                                    </tr>
                                    <tr>
                                        <td class="font-bold">คลังสินค้า</td>
                                        <td>จันทร์ - ศุกร์</td>
                                        <td>07:00 - 16:00</td>
                                        <td>12:00 - 13:00</td>
                                    </tr>
                                    <tr>
                                        <td class="font-bold">ฝ่ายขาย</td>
                                        <td>จันทร์ - ศุกร์ (เสาร์ตามปฏิทิน)</td>
                                        <td>08:00 - 17:00</td>
                                        <td>12:00 - 13:00</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="text-xs text-gray-500 p-2">* ชั่วโมงทำงานรายสัปดาห์ 40 ชั่วโมง (8 ชัวโมงต่อวัน) (ฝ่ายขายไม่เกิน 48 ชั่วโมง)</p>
                        </div>
                        <h4 class="font-bold text-red-700 mb-3 text-lg mt-6">เงื่อนไขเพิ่มเติม</h4>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm w-full">
                                <h5 class="font-bold text-gray-800 flex items-center gap-2 mb-2">
                                    <i data-lucide="home" class="w-4 h-4 text-blue-500"></i> Work from Home
                                </h5>
                                <p class="text-sm text-gray-600">นโยบายทำงานที่บ้าน 1 วัน/สัปดาห์ (ต้องได้รับอนุมัติ) <u>ยกเว้น</u> แผนกคลังสินค้า, มาสเตอร์เซอร์วิส และฝ่ายขาย</p>
                            </div>
                            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm w-full">
                                <h5 class="font-bold text-gray-800 flex items-center gap-2 mb-2">
                                    <i data-lucide="clock-alert" class="w-4 h-4 text-orange-500"></i> เวลาทำงานติดลบ
                                </h5>
                                <p class="text-sm text-gray-600">สิ้นเดือนหากชั่วโมงทำงานติดลบ จะถูกหักวันลาพักร้อนอย่างน้อย 0.5 วัน หากวันลาหมดจะมีผลทางวินัย</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Chapter 3 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-3')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 3</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">การออกจากการเป็นพนักงานบริษัท</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-3" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-3" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="file-warning" class="w-5 h-5"></i> 3.1 การสิ้นสุดการจ้างงาน
                                </h4>
                                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm text-sm text-gray-700 space-y-3">
                                    <p>คู่สัญญาต้องบอกกล่าวล่วงหน้าเป็นหนังสือ <strong>1 รอบการจ่ายค่าจ้าง</strong> (1 เดือน) หรือจ่ายสินจ้างแทนการบอกกล่าว</p>
                                    <ul class="list-disc list-outside ml-5 text-gray-600">
                                        <li>ช่วงทดลองงาน: บอกกล่าว 1 เดือน</li>
                                        <li>พนักงานบรรจุ: บอกกล่าว 1 เดือน</li>
                                    </ul>
                                    <p class="text-xs text-red-600">* บริษัทขอสงวนสิทธิ์เลิกจ้างทันทีหากปฏิบัติงานไม่มีคุณภาพ, ผิดวินัย, หรือมีพฤติกรรมที่เป็นอันตราย</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="list-checks" class="w-5 h-5"></i> 3.2 ขั้นตอนการเลิกจ้าง
                                </h4>
                                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm text-sm text-gray-700">
                                    <ul class="space-y-2">
                                        <li class="flex items-start gap-2">
                                            <i data-lucide="check-square" class="w-4 h-4 text-green-500 mt-0.5"></i>
                                            <span>คืนทรัพย์สินทั้งหมดของบริษัท</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i data-lucide="check-square" class="w-4 h-4 text-green-500 mt-0.5"></i>
                                            <span>ชำระหนี้สินคงค้างทั้งหมด</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i data-lucide="gift" class="w-4 h-4 text-orange-500 mt-0.5"></i>
                                            <span>สิทธิรับเงินค่าวันหยุดพักผ่อนที่ไม่ได้ใช้ (หากปฏิบัติตามขั้นตอนครบถ้วน)</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="user-x" class="w-5 h-5"></i> 3.3 การละทิ้งงาน
                                </h4>
                                <div class="bg-red-50 p-4 rounded-lg border border-red-100 text-sm text-red-800">
                                    <p>การขาดงานโดยไม่แจ้งหรือไม่มีเหตุอันสมควรติดต่อกัน <strong>3 วันทำการ</strong> ถือว่าละทิ้งงาน อาจนำไปสู่การเลิกจ้างทันทีและอาจถูกหักค่าจ้าง</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="hourglass" class="w-5 h-5"></i> 3.4 เกษียณอายุ
                                </h4>
                                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm text-sm text-gray-700">
                                    <p>เกษียณอายุอย่างเป็นทางการใน <strong>วันครบรอบวันเกิดปีที่ 60</strong> (สิ้นสุดวันสุดท้ายของเดือนเกิด)</p>
                                    <p class="text-xs text-gray-500 mt-1">* บริษัทอาจเสนอจ้างงานต่อได้ตามดุลพินิจ</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="message-circle" class="w-5 h-5"></i> 3.5 การสัมภาษณ์พนักงานที่ออก
                                </h4>
                                <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm text-sm text-gray-700">
                                    <p>พนักงานอาจต้องเข้ารับการสัมภาษณ์กับ <strong>หัวหน้าแผนก</strong> หรือ <strong>ฝ่ายบริหารอาวุโส</strong> เมื่อสิ้นสุดการจ้างงาน</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Chapter 4 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-4')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 4</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">สวัสดิการรักษาพยาบาล</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-4" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-4" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="space-y-6">
                            <div>
                                <h4 class="font-bold text-red-700 mb-2">4.1 ประกันชีวิตและสุขภาพ (Group Insurance)</h4>
                                <ul class="list-disc list-outside ml-5 space-y-2 text-sm text-gray-700">
                                    <li>มีผลบังคับใช้เมื่อ<strong>ผ่านการทดลองงาน</strong>แล้ว</li>
                                    <li>วงเงินคุ้มครอง OPD/IPD ขึ้นอยู่กับแผนประกันที่บริษัทจัดให้</li>
                                    <li>มีสวัสดิการตรวจสุขภาพประจำปี</li>
                                </ul>
                            </div>
                            <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm bg-white table-container">
                                <table class="manual-table">
                                    <thead>
                                        <tr>
                                            <th>สวัสดิการ</th>
                                            <th>วงเงิน / รายละเอียด</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="font-bold flex items-center gap-2"><i data-lucide="smile" class="w-4 h-4 text-blue-500"></i> ทันตกรรม</td>
                                            <td><span class="font-semibold">รวม 4,000 บาท/ปี</span></td>
                                        </tr>
                                        <tr>
                                            <td class="font-bold flex items-center gap-2"><i data-lucide="glasses" class="w-4 h-4 text-indigo-500"></i> จักษุวิทยา</td>
                                            <td><span class="font-semibold">สูงสุด 4,000 บาท/ปี</span> (เฉพาะเลนส์-ไม่รวมกรอบแว่น)</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Chapter 5 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-5')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 5</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">ผลตอบแทนพิเศษ</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-5" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-5" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                         <div class="space-y-6">
                            <!-- 1.1 Domestic Travel -->
                            <div>
                                <h4 class="font-bold text-red-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="map-pin" class="w-5 h-5"></i> 5.1 การเบิกค่าใช้จ่ายในการเดินทาง (ในประเทศ)
                                </h4>
                                <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm mb-4 bg-white table-container">
                                    <table class="manual-table">
                                        <thead>
                                            <tr>
                                                <th>ประเภทพนักงาน</th>
                                                <th>ยานพาหนะ</th>
                                                <th>อัตราเบิก (บาท/กม.)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td rowspan="2" class="font-semibold">พนักงานภายใน</td>
                                                <td>รถยนต์</td>
                                                <td>8</td>
                                            </tr>
                                            <tr>
                                                <td>รถจักรยานยนต์</td>
                                                <td>5</td>
                                            </tr>
                                            <tr>
                                                <td class="font-semibold">พนักงานฝ่ายขาย</td>
                                                <td>รถยนต์</td>
                                                <td>3 (ต้องขออนุมัติ หรือใช้ Fleet Card)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <ul class="list-disc list-outside ml-5 space-y-1 text-sm text-gray-700">
                                    <li><strong>เงื่อนไข</strong> บริษัทสนับสนุนค่าใช้จ่ายในการเดินทางสําหรับพนักงานที่ต้องการเดินทางเพื่อวัตถุประสงค์ทางธุรกิจเท่านั้น </li>
                                    <li><strong>รถยนต์ไฟฟ้า (EV):</strong> เบิกตามค่าชาร์จจริง (ต้องมีหลักฐาน)</li>
                                    <li><strong>ทางด่วน/จอดรถ:</strong> เบิกตามจริง (ต้องมีใบเสร็จ)</li>
                                </ul>
                            </div>
                            <!--1.3 นโยบายการใช้มือถือ-->
                            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="file-check" class="w-5 h-5"></i> 5.2 นโยบายโทรศัพท์มือถือและอุปกรณ์อิเล็กทรอนิกส์ 
                                </h4>
                                <ul class="list-disc list-outside ml-5 text-sm text-gray-700 space-y-2">
                                    <li><strong>สิทธิ์การใช้งานตามความจำเป็น:</strong> บริษัทจะจัดสรรอุปกรณ์ (มือถือ, แล็ปท็อป, ไอแพด) และเบอร์โทรศัพท์ให้ตามความเหมาะสมของตำแหน่งงาน โดยการพิจารณาของฝ่ายบริหาร</li>
                                    <li><strong>กรรมสิทธิ์และวัตถุประสงค์:</strong> อุปกรณ์ เบอร์โทรศัพท์ และบัญชีใช้งานทั้งหมด (Apple ID, LINE ฯลฯ) ถือเป็น<strong>ทรัพย์สินของบริษัท</strong>ให้ใช้เพื่อวัตถุประสงค์ทางธุรกิจเท่านั้น</li>
                                    <li><strong>ข้อห้ามในการจัดการบัญชี:</strong>ห้ามแก้ไขการตั้งค่า (รหัสผ่าน/อีเมล) ห้ามลบข้อมูลลูกค้าหรือประวัติการสนทนา และห้ามโอนสิทธิ์การเข้าถึงบัญชีโดยเด็ดขาด</li>
                                    <li><strong>บทลงโทษทางวินัย:</strong> การแก้ไขหรือลบข้อมูลโดยไม่ได้รับอนุญาตถือเป็น ความผิดวินัยร้ายแรง ซึ่งอาจส่งผลให้ถูกดำเนินการทางวินัยหรือเลิกจ้างได้</li>
                                </ul>
                            </div>
                            <!-- 1.5.1 Travel Class -->
                            <h5 class="font-bold text-gray-800 mb-2 text-sm ml-2">5.3.1 ชั้นการเดินทางและสิทธิการเบิก</h5>
                            <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm mb-4 bg-white table-container">
                                <table class="manual-table">
                                    <thead>
                                        <tr>
                                            <th>รายการ</th>
                                            <th>สิทธิที่เบิกได้</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="font-semibold">พนักงานภายใน <br><span class="text-xs font-normal text-gray-500">(ที่ไม่ได้รับฟลีทการ์ด)</span></td>
                                            <td>
                                                <div class="mb-1">รถยนต์: 8 บาท/กม.</div>
                                                <div>รถจักรยานยนต์: 5 บาท/กม.</div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="font-semibold">พนักงานฝ่ายขาย</td>
                                            <td>อนุมัติจากผู้อำนวยการฝ่ายขายก่อนเท่านั้น</td>
                                        </tr>
                                        <tr>
                                            <td>แท็กซี่</td>
                                            <td>ตามใบเสร็จ</td>
                                        </tr>
                                        <tr>
                                            <td>การบิน</td>
                                            <td>ชั้นประหยัด</td>
                                        </tr>
                                        <tr>
                                            <td>ภาษีสนามบิน</td>
                                            <td>ตามใบเสร็จ</td>
                                        </tr>
                                        <tr>
                                            <td>ค่าผ่านทางและที่จอดรถ</td>
                                            <td>ตามใบเสร็จ</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <!-- 1.5.7 & 1.5.8 Allowances --> 
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm">
                                <div class="bg-white p-3 rounded border border-gray-200 w-full">
                                    <p class="font-bold text-gray-800">5.3.2 เบี้ยเลี้ยง (Per Diem)</p>
                                    <ul class="mt-1 space-y-1 text-gray-600">
                                        <li>ในประเทศ: <strong>270 บาท/วัน</strong> (เฉพาะพนักงานภายใน)</li>
                                        <li>ต่างประเทศ: <strong>500 บาท/วัน</strong> (ค่าของว่าง/เครื่องดื่ม) + ค่าอาหารตามจริง (สูงสุด 3,100)</li>
                                    </ul>
                                </div>
                                <div class="bg-white p-3 rounded border border-gray-200 w-full">
                                    <p class="font-bold text-gray-800">5.3.3 ค่าที่พัก (Accommodation)</p>
                                    <ul class="mt-1 space-y-1 text-gray-600">
                                        <li>ในประเทศ: <strong>550 บาท/คืน</strong> (หรือโรงแรมพันธมิตร)</li>
                                        <li>ต่างประเทศ: ตามเรทเมืองที่ไป (จองผ่านธุรการ)</li>
                                        <li>ห้ามชาย-หญิงพักห้องเดียวกัน</li>
                                    </ul>
                                </div>
                            </div>
                            <!-- 1.6 Conditions -->
                            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="file-check" class="w-5 h-5"></i> 5.4 เงื่อนไขการขอเบิกค่าใช้จ่าย
                                </h4>
                                <ul class="list-disc list-outside ml-5 text-sm text-gray-700 space-y-2">
                                    <li>ค่าเดินทางยื่นอย่างช้าที่สุดในเดือนถัดไป</li>
                                    <li>ส่งใบขอเบิกพร้อมใบเสร็จต้นฉบับที่แผนกบัญชี <strong>ก่อนวันที่ 22 ของเดือน</strong></li>
                                    <li>หากเกินกำหนดจะถูกนำไปจ่ายในรอบเดือนถัดไป</li>
                                    <li>บริษัทสงวนสิทธิ์ปฏิเสธการจ่ายหากไม่มีเอกสารตัวจริง</li>
                                </ul>
                            </div>
                            <!-- 1.8 Training -->
                            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="graduation-cap" class="w-5 h-5"></i> 5.5 การฝึกอบรมและการพัฒนา
                                </h4>
                                <ul class="list-disc list-outside ml-5 text-sm text-gray-700 space-y-2">
                                    <li>สิทธิเข้าร่วมอบรมสูงสุด <strong>40 ชั่วโมงต่อปี</strong> (รวมภายใน/ภายนอก)</li>
                                    <li>พนักงานที่ยื่นใบลาออก/ถูกสอบสวน ไม่มีสิทธิอบรม</li>
                                    <li>อาจต้องลงนามใน <strong>ข้อตกลงสัญญาค้ำประกัน</strong> สำหรับการอบรมที่บริษัทคัดเลือกให้</li>
                                    <li>ต้องส่งแบบประเมินผลการอบรมให้ HR ภายใน 2 วันทำการหลังอบรมจบ</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Chapter 6 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-6')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 6</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">การบริหารจัดการเงินเดือน</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-6" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-6" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                         <div class="space-y-6">
                            <!-- Salary -->
                            <div>
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="banknote" class="w-5 h-5"></i> 6.1 การจ่ายเงินเดือน
                                </h4>
                                <p class="text-sm text-gray-700">จ่ายใน <strong>วันศุกร์สุดท้ายของเดือน</strong> (หรือวันทำการสุดท้ายหากตรงกับวันหยุด)</p>
                            </div>
                            <!-- Provident Fund -->
                            <div>
                                <h4 class="font-bold text-red-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="piggy-bank" class="w-5 h-5"></i> 6.2 กองทุนสำรองเลี้ยงชีพ (EPF)
                                </h4>
                                <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm bg-white table-container">
                                    <table class="manual-table">
                                        <thead>
                                            <tr>
                                                <th>อายุงาน</th>
                                                <th>เงินสมทบ (บริษัท)</th>
                                                <th>เงินสะสม (พนักงาน)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>&lt; 2 ปี</td>
                                                <td>5%</td>
                                                <td>5 - 15%</td>
                                            </tr>
                                            <tr>
                                                <td>2 - &lt; 5 ปี</td>
                                                <td>สูงสุด 8%</td>
                                                <td>5 - 15%</td>
                                            </tr>
                                            <tr>
                                                <td>&ge; 5 ปี</td>
                                                <td>สูงสุด 10%</td>
                                                <td>5 - 15%</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- 1.5 Salary Increase & Bonus -->
                            <div>
                                <h4 class="font-bold text-red-700 mb-2 flex items-center gap-2">
                                    <i data-lucide="trending-up" class="w-5 h-5"></i> 6.5 การขึ้นเงินเดือนและโบนัส
                                </h4>
                                <div class="bg-white p-4 rounded-lg border border-gray-200 text-sm text-gray-700 space-y-2 shadow-sm">
                                    <p>ขึ้นอยู่กับ <strong>ดุลพินิจของบริษัท</strong> และผลการปฏิบัติงานประจำปี โดยพิจารณาจาก:</p>
                                    <ul class="list-disc list-outside ml-5 text-gray-600">
                                        <li>การปรับปรุงผลงาน</li>
                                        <li>ความน่าเชื่อถือและทัศนคติ</li>
                                        <li>ความร่วมมือและการปฏิบัติตามวินัย</li>
                                        <li>การประเมินผลการปฏิบัติงานประจําปี</li>
                                    </ul>
                                    <p class="text-xs text-gray-500 mt-2">* ไม่ถือเป็นสิทธิตามกฎหมายที่ต้องได้รับทุกปี</p>
                                </div>
                            </div>
                            <!-- 1.6 OT -->
                            <div>
                                <h4 class="font-bold text-red-700 mb-3 flex items-center gap-2">
                                    <i data-lucide="clock" class="w-5 h-5"></i> 6.6 การทำงานล่วงเวลา (OT)
                                </h4>
                                <!-- Rates Table -->
                                <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm bg-white mb-4 table-container">
                                    <table class="manual-table">
                                        <thead>
                                            <tr>
                                                <th>ประเภทการทำงาน</th>
                                                <th>อัตราค่าตอบแทน (เงินเดือนต่อชั่วโมง)</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>ล่วงเวลาในวันทำงานปกติ</td>
                                                <td><span class="font-bold text-red-600">1.5 เท่า</span></td>
                                            </tr>
                                            <tr>
                                                <td>ทำงานในวันหยุด (เวลาปกติ)</td>
                                                <td><span class="font-bold text-red-600">1-2 เท่า</span></td>
                                            </tr>
                                            <tr>
                                                <td>ล่วงเวลาในวันหยุด</td>
                                                <td><span class="font-bold text-red-600">3 เท่า</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- Conditions -->
                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm">
                                    <div class="bg-red-50 p-3 rounded border border-red-100 w-full">
                                        <span class="font-bold text-red-800 block mb-1">ข้อยกเว้น (ไม่นับเป็น OT)</span>
                                        <ul class="list-disc list-outside ml-4 text-red-700 space-y-1">
                                            <li>ช่วงเวลาพัก</li>
                                            <li>วันลาป่วย / วันพักผ่อนประจำปีและการขาดงานอื่นๆ</li>
                                            <li>การเข้าร่วมฝึกอบรมในวันหยุด</li>
                                        </ul>
                                    </div>
                                    <div class="bg-gray-50 p-3 rounded border border-gray-200 w-full">
                                        <span class="font-bold text-gray-800 block mb-1">ขั้นตอนการเบิก</span>
                                        <ul class="list-disc list-outside ml-4 text-gray-600 space-y-1">
                                            <li><u>ต้องได้รับอนุมัติจากหัวหน้าก่อนทำ</u></li>
                                            <li>ส่งแบบฟอร์มภายในวันที่ <strong>20 ของเดือน</strong></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Chapter 7 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-7')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 7</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">จริยธรรมทางธุรกิจ</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-7" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-7" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm w-full">
                                 <h5 class="font-bold text-red-700 flex items-center gap-2 mb-2">
                                    <i data-lucide="shield-check" class="w-5 h-5"></i> ความซื่อสัตย์
                                </h5>
                                <ul class="list-disc list-outside ml-5 space-y-1 text-sm text-gray-700">
                                    <li>ปฏิบัติตามกฎหมายและมาตรฐานจริยธรรมสูงสุด</li>
                                    <li>ห้ามเปิดเผยข้อมูลความลับของบริษัท/ลูกค้า</li>
                                    <li>ห้ามใช้ซอฟต์แวร์ละเมิดลิขสิทธิ์</li>
                                    <li>ต้องเคารพความเป็นส่วนตัวของผู้ใช้รายอื่นตลอดเวลา ไฟล์ แผ่นดิสก์ จดหมายอิเล็กทรอนิกส์ ข้อมูล ฯลฯ</li>
                                </ul>
                            </div>
                            <div class="bg-white p-4 rounded-lg border border-gray-200 shadow-sm w-full">
                                <h5 class="font-bold text-red-700 flex items-center gap-2 mb-2">
                                    <i data-lucide="users" class="w-5 h-5"></i> พฤติกรรมส่วนบุคคลและจริยธรรม
                                </h5>
                                <ul class="list-disc list-outside ml-5 space-y-1 text-sm text-gray-700">
                                    <li>ห้ามประกอบธุรกิจแข่งขันกับบริษัท</li>
                                    <li>ห้ามรับของกำนัลที่มีมูลค่าสูงหรือสินบน</li>
                                    <li>ห้ามยืมเงินลูกค้าหรือคู่ค้า</li>
                                    <li>การอ้างชื่อบริษัท ห้ามใช้ชื่อหรือความสัมพันธ์กับบริษัทไปรับรอง/ส่งเสริมองค์กรอื่น</li>
                                    <li>การนําเข้าสู่ระบบซึ่งสิ่งลามกอนาจารหรือสิ่งที่คุกคามในพื้นที่ที่สามารถเข้าถึงได้อย่างสาธารณะ </li>
                                    <li>ต้องเชื่อฟังอย่างสุจริตและอย่างเต็มที่และปฏิบัติตามและและเคารพซึ่งกฎหมาย ฯลฯ</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-4 bg-white p-4 rounded-lg border border-red-100 text-sm text-red-800">
                            <strong>นโยบายไอที:</strong> ห้ามใช้คอมพิวเตอร์บริษัทเพื่อธุรกิจส่วนตัว ห้ามแฮ็ก หรือละเมิดความเป็นส่วนตัวผู้อื่น
                        </div>
                        <div class="mt-4 bg-red-50 p-4 rounded-lg border border-red-100 text-sm text-red-800">
                            <strong>หมายเหตุ:</strong> "เนื้อหาข้างต้นเป็นเพียงสรุปสาระสำคัญของข้อห้ามและจริยธรรมในการปฏิบัติงานเบื้องต้นเท่านั้นพนักงานมีหน้าที่ต้องศึกษาและปฏิบัติตามนโยบายบริษัทฉบับเต็มอย่างเคร่งครัดเพื่อรักษามาตรฐานขององค์กร"
                        </div>
                    </div>
                </div>
                <!-- Chapter 8 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-8')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 8</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">กฎระเบียบและข้อบังคับ</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-8" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-8" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-bold text-red-700 mb-2">บทลงโทษทางวินัย</h4>
                                <div class="flex flex-wrap gap-2 text-sm">
                                    <span class="bg-white border border-gray-200 px-3 py-1 rounded-full">1. ตักเตือนด้วยวาจา</span>
                                    <span class="bg-white border border-gray-200 px-3 py-1 rounded-full">2. ตักเตือนเป็นหนังสือ</span>
                                    <span class="bg-white border border-gray-200 px-3 py-1 rounded-full">3. พักงาน (ไม่จ่ายค่าจ้าง)</span>
                                    <span class="bg-red-100 text-red-700 border border-red-200 px-3 py-1 rounded-full font-bold">4. เลิกจ้าง</span>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 text-sm">
                                <div class="bg-white p-4 rounded-lg border border-red-200 border-l-4 border-l-red-500 w-full">
                                    <h5 class="font-bold text-red-800 mb-2">ความผิดร้ายแรง (เลิกจ้างทันที/ไม่จ่ายชดเชย)</h5>
                                    <ul class="list-disc list-outside ml-5 space-y-1 text-gray-700">
                                        <li>ทุจริต / ยักยอกเงิน / สร้างยอดขายเท็จ</li>
                                        <li>ละทิ้งหน้าที่ติดต่อกัน 3 วันทำงาน</li>
                                        <li>เสพยาเสพติด / ดื่มสุราในบริษัท / การโจรกรรม </li>
                                        <li>เปิดเผยความลับบริษัท / ปลอมเอกสาร</li>
                                        <li>การกลั่นแกล้ง / การคุกคาม / และการเลือกปฏิบัต</li>
                                    </ul>
                                </div>
                                <div class="bg-white p-4 rounded-lg border border-gray-200 w-full">
                                    <h5 class="font-bold text-gray-800 mb-2">ความผิดทั่วไป (ตักเตือน)</h5>
                                    <ul class="list-disc list-outside ml-5 space-y-1 text-gray-600">
                                        <li>มาสาย / ขาดงานโดยไม่ลา</li>
                                        <li>ใช้เวลางานทำธุระส่วนตัว</li>
                                        <li>แต่งกายไม่สุภาพ</li>
                                        <li>การพาบุคคลภายนอกมาที่สํานักงานโดยไม่ได้รับอนุญาต</li>
                                        <li>แต่งกายไม่สุภาพ</li>
                                    </ul>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-bold text-red-700 mb-2">ค่าชดเชยกรณีเลิกจ้าง (ตามกฎหมาย)</h4>
                                <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-sm bg-white table-container">
                                    <table class="manual-table">
                                        <thead>
                                            <tr>
                                                <th>อายุงาน</th>
                                                <th>ค่าชดเชย</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>120 วัน - 1 ปี</td><td>30 วัน</td></tr>
                                            <tr><td>1 - 3 ปี</td><td>90 วัน</td></tr>
                                            <tr><td>3 - 6 ปี</td><td>180 วัน</td></tr>
                                            <tr><td>6 - 10 ปี</td><td>240 วัน</td></tr>
                                            <tr><td>10 - 20 ปี</td><td>300 วัน</td></tr>
                                            <tr><td>20 ปีขึ้นไป</td><td>400 วัน</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <div class="mt-4 bg-red-50 p-4 rounded-lg border border-red-100 text-sm text-red-800">
                            <strong>หมายเหตุ:</strong> "เนื้อหาข้างต้นเป็นเพียงสรุปสาระสำคัญของข้อห้ามและจริยธรรมในการปฏิบัติงานเบื้องต้นเท่านั้นพนักงานมีหน้าที่ต้องศึกษาและปฏิบัติตามนโยบายบริษัทฉบับเต็มอย่างเคร่งครัดเพื่อรักษามาตรฐานขององค์กร"
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Chapter 9 -->
                <div class="border border-gray-200 rounded-xl bg-white shadow-sm overflow-hidden">
                    <button onclick="toggleAccordion('manual-9')" class="w-full px-4 py-3 sm:px-6 sm:py-4 flex items-center justify-between bg-white hover:bg-red-50 transition-colors">
                        <div class="flex items-center gap-3">
                            <span class="bg-red-100 text-red-700 font-bold px-2 py-1 rounded text-sm">บทที่ 9</span>
                            <span class="font-bold text-base sm:text-lg text-gray-800">กระบวนการร้องทุกข์</span>
                        </div>
                        <i data-lucide="chevron-down" id="icon-manual-9" class="w-5 h-5 text-gray-400 transition-transform duration-300"></i>
                    </button>
                    <div id="manual-9" class="hidden bg-gray-50 p-3 sm:p-6 border-t border-gray-100">
                        <p class="text-sm text-gray-600 mb-4">สำหรับพนักงานที่รู้สึกไม่ได้รับความเป็นธรรมในการปฏิบัติงาน หรือมีข้อขัดแย้ง (ไม่ใช่การขอเลื่อนตำแหน่งหรือเรื่องส่วนตัว)</p>
                        <div class="relative pl-8 space-y-6 before:content-[''] before:absolute before:left-3 before:top-2 before:bottom-2 before:w-0.5 before:bg-gray-200">
                            <!-- Step 1 -->
                            <div class="relative">
                                <div class="absolute -left-8 bg-red-100 text-red-700 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border border-red-200">1</div>
                                <h5 class="font-bold text-gray-800 text-sm">ขั้นตอนที่ 1: หารือหัวหน้างาน</h5>
                                <p class="text-sm text-gray-600 mt-1">พูดคุยกับผู้บังคับบัญชาโดยตรงหรือหัวหน้าหน่วยธุรกิจของตนก่อนเพื่อแก้ปัญหาเบื้องต้น</p>
                            </div>
                            <!-- Step 2 -->
                            <div class="relative">
                                <div class="absolute -left-8 bg-red-100 text-red-700 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border border-red-200">2</div>
                                <h5 class="font-bold text-gray-800 text-sm">ขั้นตอนที่ 2: ยื่นเรื่องต่อฝ่ายบริหาร</h5>
                                <p class="text-sm text-gray-600 mt-1">หากไม่ได้รับการแก้ไขใน <strong>3 วันทำการ</strong> ให้ยื่นหนังสือต่อ HR เพื่อขอนัดพบผู้บริหารระดับสูง (COO/CEO/MD)</p>
                            </div>
                            <!-- Step 3 -->
                            <div class="relative">
                                <div class="absolute -left-8 bg-red-100 text-red-700 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold border border-red-200">3</div>
                                <h5 class="font-bold text-gray-800 text-sm">ขั้นตอนที่ 3: การตัดสิน</h5>
                                <p class="text-sm text-gray-600 mt-1">HR จะนัดหมายภายใน 7 วัน และฝ่ายบริหารจะแจ้งผลการตัดสินภายใน <strong>3 วันทำการ</strong> หลังการประชุม (ถือเป็นที่สิ้นสุด)</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ================= CALCULATOR SECTION ================= -->
        <section id="calculator-section" class="content-section fade-in mb-8 hidden">
            <div class="flex items-center gap-3 mb-4 sm:mb-6 pb-4 border-b border-gray-200">
                <div class="p-2 sm:p-3 rounded-xl bg-gradient-to-br from-red-600 to-red-800 text-white shadow-md">
                    <i data-lucide="calculator" class="w-5 h-5 sm:w-6 sm:h-6"></i>
                </div>
                <div>
                    <h2 class="text-lg sm:text-2xl font-bold text-gray-800">คำนวณสิทธิวันลาพักร้อน</h2>
                    <p class="text-xs sm:text-sm text-gray-500">ตรวจสอบสิทธิตามอายุงานและนโยบายบริษัท</p>
                </div>
            </div>
            <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                <!-- Input Panel -->
                <div class="xl:col-span-1 bg-white p-6 rounded-xl shadow-lg border-t-4 border-red-700 w-full">
                    <label class="block text-sm font-medium text-gray-700 mb-2">วันที่เริ่มงาน </label>
                    <input type="date" id="start-date" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-red-500 focus:border-red-500 outline-none transition-all mb-4 text-gray-700" onchange="calculateLeave()">
                    
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-100 text-sm space-y-2">
                        <p class="text-gray-600"><span class="font-semibold text-gray-800">วันนี้:</span> <span id="current-date-display">-</span></p>
                        <p class="text-gray-600"><span class="font-semibold text-gray-800">อายุงาน:</span> <span id="tenure-display" class="text-red-600 font-bold">-</span></p>
                    </div>

                    <button onclick="calculateLeave()" class="w-full mt-4 bg-red-700 text-white py-3 rounded-lg font-bold hover:bg-red-800 transition-colors shadow-md active:transform active:scale-95">
                        คำนวณสิทธิ
                    </button>
                </div>
                <!-- Result Panel -->
                <div class="xl:col-span-2 bg-white p-6 rounded-xl shadow-md border border-gray-100 flex flex-col justify-center items-center text-center min-h-[300px] w-full" id="result-container">
                    <!-- Default State -->
                    <div id="result-placeholder" class="text-center p-6">
                        <div class="bg-gray-100 p-4 rounded-full inline-block mb-4">
                            <i data-lucide="calendar-search" class="w-12 h-12 text-gray-400"></i>
                        </div>
                        <h3 class="text-lg font-medium text-gray-500">กรุณาระบุวันที่เริ่มงาน</h3>
                        <p class="text-sm text-gray-400 mt-1">ระบบจะคำนวณสิทธิวันลาตามระเบียบให้คุณอัตโนมัติ</p>
                    </div>
                    <!-- Result State (Hidden by default) -->
                    <div id="result-content" class="hidden w-full max-w-md mx-auto">
                        <div class="mb-2">
                            <span class="px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider" id="status-badge"></span>
                        </div>
                        <h3 class="text-3xl lg:text-4xl font-extrabold text-gray-800 mb-2">
                            <span id="leave-days" class="text-red-600">0</span> วัน
                        </h3>
                        <p class="text-gray-500 mb-6">สิทธิวันหยุดพักผ่อนประจำปีของคุณ</p>
                        
                        <div class="bg-red-50 rounded-lg p-4 text-left border-l-4 border-red-600">
                            <h4 class="font-bold text-red-800 mb-1 flex items-center gap-2">
                                <i data-lucide="info" class="w-4 h-4"></i> รายละเอียด
                            </h4>
                            <p id="calculation-detail" class="text-sm text-red-700 leading-relaxed"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- ADMIN FAB (Floating Action Button) -->
    <div id="admin-fab" class="hidden fab-btn" onclick="openNewPostModal()" title="เพิ่มประกาศใหม่">
        <i data-lucide="plus" class="w-6 h-6"></i>
    </div>

    <!-- ADMIN LOGIN MODAL -->
    <div id="login-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-xs p-6 relative">
            <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i data-lucide="x" class="w-5 h-5"></i></button>
            <h3 class="text-lg font-bold text-gray-800 mb-4 text-center">Admin Console</h3>
            <div class="space-y-4">
                <input type="text" id="admin-user" placeholder="Username" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none text-sm">
                <input type="password" id="admin-pass" placeholder="Password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none text-sm">
                <button id="login-submit-btn" onclick="submitLogin()" class="w-full bg-red-700 hover:bg-red-800 text-white font-bold py-2 rounded-lg transition-colors text-sm">เข้าสู่ระบบ</button>
            </div>
        </div>
    </div>

    <!-- NEW POST MODAL (With Rich Text) -->
    <div id="new-post-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[100] flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-6 relative">
            <button onclick="closeNewPostModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i data-lucide="x" class="w-5 h-5"></i></button>
            <h3 class="text-xl font-bold text-gray-800 mb-4">เพิ่มประกาศใหม่</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">หัวข้อประกาศ</label>
                    <input type="text" id="new-post-topic" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none" placeholder="ใส่หัวข้อเรื่อง...">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">เนื้อหา</label>
                    <!-- Rich Text Toolbar -->
                    <div class="rich-toolbar">
                        <button class="tool-btn" onclick="execCmd('bold')" title="ตัวหนา"><i data-lucide="bold" class="w-4 h-4"></i></button>
                        <button class="tool-btn" onclick="execCmd('italic')" title="ตัวเอียง"><i data-lucide="italic" class="w-4 h-4"></i></button>
                        <button class="tool-btn" onclick="execCmd('underline')" title="ขีดเส้นใต้"><i data-lucide="underline" class="w-4 h-4"></i></button>
                        <div class="w-px h-6 bg-gray-300 mx-1"></div>
                        <input type="color" id="color-picker" class="h-8 w-8 p-0 border-0 cursor-pointer" title="สีตัวอักษร" onchange="execCmd('foreColor', this.value)">
                        <button class="tool-btn bg-yellow-200 hover:bg-yellow-300 border-yellow-300" onclick="execCmd('backColor', 'yellow')" title="ไฮไลท์"><i data-lucide="highlighter" class="w-4 h-4"></i></button>
                        <div class="w-px h-6 bg-gray-300 mx-1"></div>
                        <button class="tool-btn" onclick="triggerImageUpload()" title="แทรกรูปภาพ"><i data-lucide="image" class="w-4 h-4"></i></button>
                        <!-- Hidden File Input -->
                        <input type="file" id="img-input" accept="image/*" hidden onchange="handleImageUpload(event)">
                    </div>
                    <div id="new-post-content" class="rich-editor" contenteditable="true" placeholder="พิมพ์เนื้อหาที่นี่..."></div>
                </div>
                <button onclick="submitNewPost()" id="submit-post-btn" class="w-full bg-red-700 hover:bg-red-800 text-white font-bold py-3 rounded-lg transition-colors">โพสต์ประกาศ</button>
            </div>
        </div>
    </div>
    
    <!-- CHANGE PASSWORD MODAL -->
    <div id="change-password-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-[110] flex items-center justify-center p-4">
      <div class="bg-white rounded-xl shadow-2xl w-full max-w-xs p-6 relative">
        <button onclick="closeChangePasswordModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i data-lucide="x" class="w-5 h-5"></i></button>
        <h3 class="text-lg font-bold text-gray-800 mb-4 text-center">เปลี่ยนรหัสผ่าน Admin</h3>
        <div class="space-y-4">
            <div>
                <label class="text-xs text-gray-500 font-bold">Username ใหม่:</label>
                <input type="text" id="new-admin-user" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none text-sm">
            </div>
            <div>
                <label class="text-xs text-gray-500 font-bold">Password ใหม่:</label>
                <input type="password" id="new-admin-pass" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 outline-none text-sm">
            </div>
            <button onclick="submitChangePassword()" id="btn-submit-password" class="w-full bg-gray-900 hover:bg-black text-white font-bold py-2 rounded-lg transition-colors text-sm">บันทึกรหัสผ่านใหม่</button>
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-400 py-10 mt-auto border-t border-gray-800 text-center text-sm">
        <p>© Wuerth Thailand. Internal Use Only.</p>
    </footer>

    <script>
        // ==========================================
        // 🛑 กรุณาใส่ URL ของ GOOGLE APPS SCRIPT WEB APP ที่ได้จากขั้นตอนที่แล้ว
        // (ห้ามเป็น URL ที่ลงท้ายด้วย /dev ให้ใช้ /exec เท่านั้น)
        // ==========================================
        const API_URL = "https://script.google.com/macros/s/AKfycbw8NM6u6pTHD-iW7uEvDUtI-f3MA2fIvPcVCmHLIVG2LhsS0aI6Uw8FcNYyKqpUWWpQ/exec"; 
        
        // === ฟังก์ชันสำหรับยิง API ไปหา Apps Script ===
        async function callBackend(action, payload = {}) {
            try {
                // ส่งเป็น Text/Plain เพื่อหลีกเลี่ยง CORS Preflight Request
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                    body: JSON.stringify({ action: action, payload: payload })
                });
                const result = await response.json();
                if (!result.success) throw new Error(result.error);
                return result.data;
            } catch (error) {
                console.error("API Error:", error);
                throw error;
            }
        }

        // === FIREBASE REALTIME SETUP ===
        const firebaseConfig = {
            apiKey: "AIzaSyA69fQ5DbaN9r3YfxEFoVLZnbANvTKYeOM",
            authDomain: "officeheartgame-a2771.firebaseapp.com",
            databaseURL: "https://officeheartgame-a2771-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "officeheartgame-a2771",
            storageBucket: "officeheartgame-a2771.firebasestorage.app",
            messagingSenderId: "558202505214",
            appId: "1:558202505214:web:cd4651a5a3c0a3ce5ba2af",
            measurementId: "G-FG1QQHJ2EN"
        };

        function initRealtimeSync() {
            if (!firebase.apps.length) {
                try {
                    firebase.initializeApp(firebaseConfig);
                    const db = firebase.database();
                    db.ref('mainAnnouncement').on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) renderAnnouncement(data);
                    });
                    db.ref('posts').on('value', (snapshot) => {
                        const data = snapshot.val();
                        if (data) renderPosts(data);
                    });
                } catch (e) {
                    console.warn("Firebase Config Error:", e);
                }
            }
        }

        // === STATE VARIABLES ===
        let isAdmin = false;
        let adminCreds = { user: '', pass: '' };
        let editingPostId = null;

        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            fetchAllData(); 
            initRealtimeSync(); 
            checkUrlLogin();

            // Calculator Date Limit
            const dateInput = document.getElementById('start-date');
            if(dateInput) {
                const today = new Date().toISOString().split('T')[0];
                dateInput.max = today;
            }
        });

        // === FETCH DATA (เชื่อมต่อ API แบบใหม่) ===
        async function fetchAllData() {
            try {
                const data = await callBackend('getAllData');
                if(data && data.contact) renderContact(data.contact);
            } catch(e) {
                // Fallback กรณี API พังหรือยังไม่ได้ตั้งค่า
                renderContact({ phone: "094-480-1597", email: "Wadsana.Nonrucha@wuerth.co.th" });
            }
        }

        function renderAnnouncement(main) {
            if(!main) return;
            document.getElementById('announcement-loading').classList.add('hidden');
            document.getElementById('announcement-content').classList.remove('hidden');
            document.getElementById('ann-topic').innerText = main.topic;
            document.getElementById('ann-body').innerText = main.body;
            document.getElementById('edit-topic').value = main.topic;
            document.getElementById('edit-body').value = main.body;
            if (main.date) {
                const d = new Date(main.date);
                document.getElementById('ann-date').innerText = "Updated: " + d.toLocaleDateString('th-TH');
            }
        }

        function renderContact(contact) {
            if(!contact) return;
            document.getElementById('display-phone').innerText = contact.phone;
            document.getElementById('display-email').innerText = contact.email;
            document.getElementById('display-phone-link').href = 'tel:' + contact.phone;
            document.getElementById('display-email-link').href = 'mailto:' + contact.email;
            document.getElementById('edit-phone').value = contact.phone;
            document.getElementById('edit-email').value = contact.email;
        }

        function renderPosts(posts) {
            const container = document.getElementById('additional-posts-container');
            container.innerHTML = '';
            const postsArray = Array.isArray(posts) ? posts : (posts ? Object.values(posts) : []);

            postsArray.sort((a, b) => {
                if (a.pinned && !b.pinned) return -1;
                if (!a.pinned && b.pinned) return 1;
                return new Date(b.date) - new Date(a.date);
            });

            postsArray.forEach(post => {
                if (post.hidden && !isAdmin) return;

                const dateObj = new Date(post.date);
                const dateStr = dateObj.toLocaleDateString('th-TH', { day: 'numeric', month: 'short', year: 'numeric' });
                
                let cardClass = 'extra-card p-5 fade-in relative';
                if (post.pinned) cardClass += ' card-pinned';
                if (post.hidden) cardClass += ' card-hidden';

                const card = document.createElement('div');
                card.className = cardClass;
                
                let adminControls = '';
                if (isAdmin) {
                    adminControls = `
                        <div class="flex gap-2 mt-2 border-t pt-2 border-gray-200 justify-end">
                            <button onclick="togglePin('${post.id}', ${post.pinned})" class="text-xs flex items-center gap-1 px-2 py-1 rounded hover:bg-yellow-100 ${post.pinned ? 'text-yellow-600 bg-yellow-50' : 'text-gray-500'}">
                                <i data-lucide="pin" class="w-3 h-3"></i> ${post.pinned ? 'เลิกปักหมุด' : 'ปักหมุด'}
                            </button>
                            <button onclick="openEditPost('${post.id}')" class="text-xs flex items-center gap-1 px-2 py-1 rounded hover:bg-blue-100 text-blue-600">
                                <i data-lucide="pencil" class="w-3 h-3"></i> แก้ไข
                            </button>
                            <button onclick="toggleHide('${post.id}', ${post.hidden})" class="text-xs flex items-center gap-1 px-2 py-1 rounded hover:bg-gray-200 text-gray-500">
                                <i data-lucide="${post.hidden ? 'eye' : 'eye-off'}" class="w-3 h-3"></i> ${post.hidden ? 'แสดง' : 'ซ่อน'}
                            </button>
                            <button onclick="deletePost('${post.id}')" class="text-xs flex items-center gap-1 px-2 py-1 rounded hover:bg-red-100 text-red-600">
                                <i data-lucide="trash-2" class="w-3 h-3"></i> ลบ
                            </button>
                        </div>
                    `;
                }

                card.innerHTML = `
                    ${post.pinned ? '<div class="pin-badge"><i data-lucide="pin" class="w-3 h-3"></i> ปักหมุด</div>' : ''}
                    ${post.hidden && isAdmin ? '<div class="text-xs text-gray-500 mb-1 flex items-center gap-1"><i data-lucide="eye-off" class="w-3 h-3"></i> ซ่อนอยู่ (Admin เห็นเท่านั้น)</div>' : ''}
                    
                    <div class="mb-2">
                        <h3 class="text-lg font-bold text-gray-800">${post.topic}</h3>
                    </div>
                    <div class="text-gray-600 text-sm leading-relaxed mb-3 break-words">${post.content}</div>
                    <div class="text-xs text-gray-400 border-t border-gray-100 pt-2 text-right">${dateStr}</div>
                    ${adminControls}
                `;
                const imgs = card.querySelectorAll('img');
                imgs.forEach(img => img.style.maxWidth = '100%');
                container.appendChild(card);
            });
            lucide.createIcons();
        }

        // === ADMIN LOGIC ===
        async function checkUrlLogin() {
            // ใช้ URLSearchParams แทน google.script.url เพื่อดึงค่าจาก Browser ตรงๆ
            const urlParams = new URLSearchParams(window.location.search);
            const u = urlParams.get('u');
            const p = urlParams.get('p');
            
            if (u && p) {
                try {
                    const isValid = await callBackend('verifyLogin', { username: u, password: p });
                    if (isValid) {
                        adminCreds = { user: u, pass: p };
                        setAdminMode(true);
                    }
                } catch(e) { console.error("Auto Login Error:", e); }
            }
        }

        function handleAdminClick() {
            if (isAdmin) toggleEditMode();
            else document.getElementById('login-modal').classList.remove('hidden');
        }

        async function submitLogin() {
            const u = document.getElementById('admin-user').value;
            const p = document.getElementById('admin-pass').value;
            const btn = document.getElementById('login-submit-btn');

            if (!u || !p) { alert("กรุณากรอกข้อมูลให้ครบถ้วน"); return; }

            btn.innerText = "กำลังตรวจสอบ...";
            document.body.style.cursor = 'wait';
            btn.disabled = true;

            try {
                const isValid = await callBackend('verifyLogin', { username: u, password: p });
                if (isValid) { 
                    adminCreds = { user: u, pass: p }; 
                    setAdminMode(true); 
                    closeLoginModal(); 
                } else { 
                    alert('Username หรือ Password ไม่ถูกต้อง'); 
                }
            } catch(e) {
                alert('เกิดข้อผิดพลาดในการเชื่อมต่อเซิร์ฟเวอร์: ' + e.message + '\n\n*โปรดตรวจสอบว่าคุณได้ใส่ API_URL ที่ถูกต้องและ Deploy แบบ Web App อย่างถูกต้องหรือไม่');
            } finally {
                document.body.style.cursor = 'default';
                btn.innerText = "เข้าสู่ระบบ";
                btn.disabled = false;
            }
        }

        function setAdminMode(enabled) {
            isAdmin = enabled;
            const btn = document.getElementById('admin-btn');
            if (enabled) {
                btn.innerHTML = '<i data-lucide="pencil" class="w-4 h-4 text-red-600"></i>';
                document.getElementById('contact-edit-btn').classList.remove('hidden');
                document.getElementById('change-password-btn').classList.remove('hidden');
                document.getElementById('admin-fab').classList.remove('hidden');
            }
            lucide.createIcons();
            const db = firebase.database();
            db.ref('posts').once('value').then(snapshot => {
                const data = snapshot.val();
                if(data) renderPosts(data);
            });
        }
        
        function closeLoginModal() { document.getElementById('login-modal').classList.add('hidden'); }

        // === EDIT LOGIC ===
        function toggleEditMode() {
            const display = document.getElementById('announcement-content');
            const edit = document.getElementById('announcement-edit');
            const saveBtn = document.getElementById('save-btn');
            if (edit.classList.contains('hidden')) {
                display.classList.add('hidden'); edit.classList.remove('hidden'); saveBtn.classList.remove('hidden');
            } else {
                edit.classList.add('hidden'); display.classList.remove('hidden'); saveBtn.classList.add('hidden');
            }
        }

        async function saveAnnouncement() {
            const t = document.getElementById('edit-topic').value;
            const b = document.getElementById('edit-body').value;
            const btn = document.getElementById('save-btn');
            btn.innerText = "...";
            
            try {
                const res = await callBackend('saveMainAnnouncement', {
                    username: adminCreds.user, password: adminCreds.pass, topic: t, body: b
                });
                if(res && res.success) {
                    document.getElementById('ann-topic').innerText = t;
                    document.getElementById('ann-body').innerText = b;
                    toggleEditMode();
                }
            } catch(e) { alert("Error: " + e.message); }
            btn.innerHTML = '<i data-lucide="save" class="w-4 h-4"></i> บันทึก';
        }

        function toggleContactEdit() {
            const display = document.getElementById('contact-display');
            const edit = document.getElementById('contact-edit');
            if (edit.classList.contains('hidden')) { display.classList.add('hidden'); edit.classList.remove('hidden'); }
            else { edit.classList.add('hidden'); display.classList.remove('hidden'); }
        }

        async function saveContact() {
            const p = document.getElementById('edit-phone').value;
            const e = document.getElementById('edit-email').value;
            try {
                const res = await callBackend('saveContactInfo', {
                    username: adminCreds.user, password: adminCreds.pass, phone: p, email: e
                });
                if(res && res.success) {
                    renderContact({phone: p, email: e});
                    toggleContactEdit();
                }
            } catch(err) { alert("Error: " + err.message); }
        }

        // === NEW POST & RICH TEXT ===
        function openNewPostModal() { 
            editingPostId = null;
            document.getElementById('new-post-topic').value = ""; 
            document.getElementById('new-post-content').innerHTML = "";
            document.getElementById('submit-post-btn').innerText = "โพสต์ประกาศ";
            document.querySelector('#new-post-modal h3').innerText = "เพิ่มประกาศใหม่";
            document.getElementById('new-post-modal').classList.remove('hidden'); 
        }

        function openEditPost(id) {
            const db = firebase.database();
            db.ref('posts').once('value').then(snapshot => {
                const posts = snapshot.val() || [];
                const post = posts.find(p => p.id === id);
                if (post) {
                    editingPostId = id;
                    document.getElementById('new-post-topic').value = post.topic;
                    document.getElementById('new-post-content').innerHTML = post.content;
                    document.getElementById('submit-post-btn').innerText = "บันทึกการแก้ไข";
                    document.querySelector('#new-post-modal h3').innerText = "แก้ไขประกาศ";
                    document.getElementById('new-post-modal').classList.remove('hidden');
                }
            });
        }

        function closeNewPostModal() { document.getElementById('new-post-modal').classList.add('hidden'); }
        function execCmd(command, value = null) { document.execCommand(command, false, value); document.getElementById('new-post-content').focus(); }
        
        function triggerImageUpload() { document.getElementById('img-input').click(); }

        function handleImageUpload(e) {
            const file = e.target.files[0];
            if (!file) return;

            document.body.style.cursor = 'wait';
            const reader = new FileReader();
            reader.onload = async function(e) {
                const rawData = e.target.result;
                const base64Data = rawData.split(',')[1];
                const mimeType = rawData.split(';')[0].split(':')[1];
                
                try {
                    const res = await callBackend('uploadImageToDrive', {
                        username: adminCreds.user, password: adminCreds.pass, data: base64Data, mimeType: mimeType, fileName: file.name
                    });
                    if (res && res.success) {
                        const imgHtml = `<img src="${res.url}" style="max-width: 100%; border-radius: 8px; margin: 10px 0;">`;
                        document.execCommand('insertHTML', false, imgHtml);
                    }
                } catch(err) {
                    alert('Upload Error: ' + err.message);
                } finally {
                    document.body.style.cursor = 'default';
                }
            }
            reader.readAsDataURL(file);
        }

        async function submitNewPost() {
             const topic = document.getElementById('new-post-topic').value;
             const content = document.getElementById('new-post-content').innerHTML;
             const btn = document.getElementById('submit-post-btn');

            if (!topic) { alert("กรุณาใส่หัวข้อ"); return; }

            btn.innerText = "กำลังบันทึก...";
            document.body.style.cursor = 'wait';

            const postData = { id: editingPostId, topic: topic, content: content };

            try {
                const res = await callBackend('savePostServer', {
                    username: adminCreds.user, password: adminCreds.pass, postData: postData
                });
                if (res && res.success) closeNewPostModal();
            } catch(err) {
                alert("เกิดข้อผิดพลาด: " + err.message);
            } finally {
                document.body.style.cursor = 'default';
                btn.innerText = editingPostId ? "บันทึกการแก้ไข" : "โพสต์ประกาศ"; 
            }
        }

        async function togglePin(id, currentStatus) {
           await updatePostFieldServer(id, 'pinned', !currentStatus);
        }

        async function toggleHide(id, currentStatus) {
          await updatePostFieldServer(id, 'hidden', !currentStatus);
        }

        async function updatePostFieldServer(id, field, value) {
          document.body.style.cursor = 'wait';
          try {
              await callBackend('updatePostStatus', {
                  username: adminCreds.user, password: adminCreds.pass, postId: id, field: field, value: value
              });
          } catch(err) { alert("Error: " + err.message); }
          finally { document.body.style.cursor = 'default'; }
        }

        async function deletePost(id) {
            if(!confirm("ต้องการลบประกาศนี้ใช่หรือไม่?")) return;
            document.body.style.cursor = 'wait';
            try {
                await callBackend('deletePostServer', {
                    username: adminCreds.user, password: adminCreds.pass, postId: id
                });
            } catch(err) { alert("ลบไม่สำเร็จ: " + err.message); }
            finally { document.body.style.cursor = 'default'; }
        }

        // === PASSWORD CHANGE ===
        function openChangePasswordModal() {
            document.getElementById('new-admin-user').value = adminCreds.user;
            document.getElementById('new-admin-pass').value = ''; 
            document.getElementById('change-password-modal').classList.remove('hidden');
         }

        function closeChangePasswordModal() { document.getElementById('change-password-modal').classList.add('hidden'); }

        async function submitChangePassword() {
            const newU = document.getElementById('new-admin-user').value;
            const newP = document.getElementById('new-admin-pass').value;
            const btn = document.getElementById('btn-submit-password');

            if(!newU || !newP) { alert("กรุณากรอกข้อมูลให้ครบถ้วน"); return; }
            if(!confirm("คุณแน่ใจหรือไม่ว่าจะเปลี่ยนรหัสผ่านแอดมิน?")) return;

            btn.innerText = "กำลังบันทึก...";
            document.body.style.cursor = 'wait';

            try {
                const res = await callBackend('updateAdminCredentials', {
                    oldUser: adminCreds.user, oldPass: adminCreds.pass, newUser: newU, newPass: newP
                });
                if(res && res.success) {
                    alert("เปลี่ยนรหัสผ่านสำเร็จ!");
                    adminCreds.user = newU;
                    adminCreds.pass = newP;
                    closeChangePasswordModal();
                }
            } catch(err) { alert("Error: " + err.message); }
            finally {
                document.body.style.cursor = 'default';
                btn.innerText = "บันทึกรหัสผ่านใหม่";
            }
        }
        
        // === NAVIGATION & CALCULATOR LOGIC ===
        function filterContent(tab) {
            document.querySelectorAll('.content-section').forEach(el => el.classList.add('hidden'));
            document.getElementById(tab + '-section').classList.remove('hidden');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                const isActive = btn.dataset.tab === tab;
                if(isActive) {
                    btn.classList.remove('text-gray-600', 'hover:text-red-700', 'hover:bg-gray-50');
                    btn.classList.add('bg-red-50', 'text-red-700', 'ring-2', 'ring-red-200'); 
                    if(tab === 'home') btn.classList.add('border-red-100'); 
                } else {
                    btn.classList.remove('bg-red-50', 'text-red-700', 'ring-2', 'ring-red-200', 'border-red-100');
                    btn.classList.add('text-gray-600', 'hover:text-red-700', 'hover:bg-gray-50');
                }
            });

            document.querySelectorAll('.mobile-nav-btn').forEach(btn => {
                if(btn.dataset.tab === tab) {
                    btn.classList.remove('text-gray-600');
                    btn.classList.add('bg-red-50', 'text-red-700');
                } else {
                    btn.classList.remove('bg-red-50', 'text-red-700');
                    btn.classList.add('text-gray-600');
                }
            });

            document.getElementById('mobile-menu').classList.add('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function toggleAccordion(id) {
            const content = document.getElementById(id);
            const icon = document.getElementById('icon-' + id);
            content.classList.toggle('hidden');
            if (content.classList.contains('hidden')) { icon.style.transform = 'rotate(0deg)'; icon.classList.remove('rotate-180'); }
            else { icon.style.transform = 'rotate(180deg)'; icon.classList.add('rotate-180'); }
        }

        function toggleMobileMenu() { document.getElementById('mobile-menu').classList.toggle('hidden'); }

        function calculateLeave() {
            const startDateInput = document.getElementById('start-date').value;
            if (!startDateInput) return;

            const startDate = new Date(startDateInput);
            const today = new Date();
            startDate.setHours(0, 0, 0, 0); today.setHours(0, 0, 0, 0);

            if (startDate > today) {
                document.getElementById('result-placeholder').classList.add('hidden');
                document.getElementById('result-content').classList.remove('hidden');
                document.getElementById('tenure-display').innerText = "-";
                const resultBadge = document.getElementById('status-badge');
                resultBadge.className = "px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider bg-red-100 text-red-700";
                resultBadge.innerText = "วันที่ไม่ถูกต้อง";
                const leaveEl = document.getElementById('leave-days');
                leaveEl.innerText = "0"; leaveEl.className = "text-gray-400";
                document.getElementById('calculation-detail').innerHTML = "<span class='text-red-600 font-bold'>ไม่สามารถเลือกวันที่ในอนาคตได้</span><br>กรุณาเลือกวันที่เริ่มงานใหม่อีกครั้ง";
                return;
            } else {
                document.getElementById('leave-days').className = "text-red-600";
            }
            
            let diffTime = Math.abs(today - startDate);
            let daysWorked = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            let tenureYears = daysWorked / 365.25;
            
            let y = today.getFullYear() - startDate.getFullYear();
            let m = today.getMonth() - startDate.getMonth();
            let d = today.getDate() - startDate.getDate();
            if (d < 0) { m--; d += 30; }
            if (m < 0) { y--; m += 12; }
            
            document.getElementById('current-date-display').innerText = today.toLocaleDateString('th-TH');
            document.getElementById('tenure-display').innerText = `${y} ปี ${m} เดือน`;
            document.getElementById('result-placeholder').classList.add('hidden');
            document.getElementById('result-content').classList.remove('hidden');

            const resultBadge = document.getElementById('status-badge');
            const leaveDaysEl = document.getElementById('leave-days');
            const detailEl = document.getElementById('calculation-detail');

            let leaveDays = 0; let message = ""; let badgeClass = ""; let badgeText = "";

            if (daysWorked <= 119) {
                leaveDays = 0; badgeClass = "bg-gray-100 text-gray-700"; badgeText = "ช่วงทดลองงาน (Probation)";
                message = `อายุงานของคุณคือ ${daysWorked} วัน <br> ตามระเบียบบริษัท พนักงานจะได้รับสิทธิวันหยุดพักผ่อนประจำปีหลังจากผ่านช่วงทดลองงาน (119 วัน) แล้วเท่านั้น`;
            } else if (tenureYears < 1) {
                let rawLeave = (daysWorked / 365) * 14;
                leaveDays = Math.round(rawLeave * 2) / 2; if (leaveDays > 14) leaveDays = 14;
                badgeClass = "bg-orange-100 text-orange-700"; badgeText = "อายุงานไม่ถึง 1 ปี (Pro-rate)";
                message = `ผ่านช่วงทดลองงานแล้ว (อายุงาน ${daysWorked} วัน) <br> ได้รับสิทธิตามสัดส่วนจากฐาน 14 วัน <br><br> สูตร: (${daysWorked} / 365) × 14 = ${rawLeave.toFixed(2)} วัน`;
            } else {
                badgeClass = "bg-green-100 text-green-700";
                if (tenureYears < 2) { leaveDays = 14; badgeText = "อายุงาน 1 - < 2 ปี"; message = "คุณได้รับสิทธิวันหยุดพักผ่อนประจำปีตามปกติ 14 วัน เนื่องจากมีอายุงานครบ 1 ปีขึ้นไป"; } 
                else if (tenureYears < 5) { leaveDays = 17; badgeText = "อายุงาน 2 - < 5 ปี"; message = "คุณได้รับสิทธิวันหยุดพักผ่อนประจำปีเพิ่มขึ้นเป็น 17 วัน ตามอายุงาน"; } 
                else { leaveDays = 19; badgeText = "อายุงาน 5 ปีขึ้นไป"; message = "คุณได้รับสิทธิวันหยุดพักผ่อนประจำปีสูงสุด 19 วัน ตามอายุงาน"; }
            }
            resultBadge.className = `px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${badgeClass}`;
            resultBadge.innerText = badgeText;
            leaveDaysEl.innerText = leaveDays;
            leaveDaysEl.className = leaveDays > 0 ? "text-red-600" : "text-gray-400"; 
            detailEl.innerHTML = message;
        }

        filterContent('home');
    </script>
</body>
</html>
